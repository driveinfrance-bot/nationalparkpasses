generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Order {
  id                    String      @id @default(uuid())
  tallyResponseId       String?     @unique
  email                 String
  name                  String?
  vehicleRegistration   String
  country               String
  vehicleType           String
  fuelType              String
  firstRegistrationDate DateTime?
  priceCents            Int
  currency              String      @default("EUR")
  consentAt             DateTime?
  status                OrderStatus @default(draft)
  stripePaymentIntentId String?
  stripeCheckoutSessionId String?
  stripeCustomerId      String?
  uploadedFileUrl       String?
  uploadedFileName      String?
  addressName           String?
  addressStreet         String?
  addressHouseNumber    String?
  addressLocality       String?
  addressPostTown       String?
  addressCounty         String?
  addressCity           String?
  addressPostalCode     String?
  addressCountry        String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  uploads Upload[]
}

model Upload {
  id          String   @id @default(uuid())
  orderId     String
  order       Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  storagePath String
  mimeType    String?
  sizeBytes   Int?
  createdAt   DateTime @default(now())
}

model BlogPost {
  id          String   @id @default(uuid())
  slug        String   @unique
  title       String
  excerpt     String
  contentMd   String
  tags        String?
  ogImage     String?
  publishedAt DateTime?
  updatedAt   DateTime?
  isPublished Boolean  @default(false)
}

enum OrderStatus {
  draft
  paid
  processing
  done
  failed
}
